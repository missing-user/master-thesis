import sys
sys.path.append("/home/missinguser/CSE/single-stage-opt/hybrid_tokamak/laptop/")
import latexplot
latexplot.set_cmap(3)
import matplotlib.pyplot as plt

import numpy as np

# Given data from the LgradB paper https://iopscience.iop.org/article/10.1088/1361-6587/ad1a3e/pdf
x_data = [
    0.528949621485798, 0.5749579544441688, 0.6209651884073895, 0.6669716897071768, 0.7129814879924141,
    0.7589876229604848, 0.8049944905919889, 0.8510050215406595, 0.8970089585184302, 0.9430172914768009,
    0.9890226937814384, 1.0350302940763756, 1.0810356963810133, 1.1270425640125172, 1.1730475999854377,
    1.219053368621792, 1.2650580382629961, 1.3110619752407668, 1.357065545886821, 1.4030694828645918,
    1.4490726871789295, 1.4950747924981167, 1.541076165153871, 1.5870771714779084, 1.6330770788067959,
    1.6790773524674, 1.7250750618059878, 1.7710731374762918, 1.8170690151562965, 1.8630641601728675,
    1.9090593051894382, 1.9550504205571264, 2.0010419022565307, 2.0470308196339184, 2.0930175390210066,
    2.139003892076378, 2.1849865818145826, 2.2309656082356204, 2.2769435356615086, 2.322917067106797,
    2.368887301566635, 2.4148527737141574, 2.4608149488762288, 2.5067708963991175, 2.5527217152779733,
    2.598665573854212, 2.6446021057961184, 2.690528014118241, 2.7343617653733645, 2.77401077917784,
    2.809478349464353, 2.8428508941030066, 2.8741305398529344, 2.9033184380423913, 2.930413317413095,
    2.9554166171253633, 2.9783316184647144, 2.9991584557527777, 3.0199772337430755, 3.0407927880142656,
    3.0595205811990565, 3.0761630310867787, 3.0927994365011764, 3.109430804854469, 3.1260611657955417,
    3.1426824600266263, 3.1572227764135996, 3.1728061002531796, 3.1863074388364283, 3.197094002967045,
    3.2091280120702823, 3.2215668665646513, 3.2360848855611373, 3.254810798243117, 3.261785986138351,
    3.2691963089521594, 3.274298851850542, 3.278375849108147, 3.2862554916952194, 3.29460586443267,
    3.2988716507404536, 3.302935551639186, 3.3084622150825296
]

y_data = [
    5.850505260015181, 6.004730912727714, 6.227204164253422, 6.495175814987925, 6.558404669282917,
    6.849125519621797, 7.094347970751927, 7.112078425838124, 7.539294473803404, 7.693520126515933,
    8.029739376063608, 8.22946342798495, 8.56568267753262, 8.8109051286627, 9.169873577814805,
    9.483343627758103, 9.865061276514535, 10.292277324479802, 10.742242572049454, 11.169458620014666,
    11.642173067188748, 12.183135113175938, 12.76959555837194, 13.378805203172353, 14.056262446785873,
    14.710970490795047, 15.524922932034963, 16.316126173670465, 17.24382461293237, 18.217021451403024,
    19.190218289873744, 20.413656323992697, 21.614345158507298, 22.974278390252604, 24.470706819624294,
    25.989884448600378, 27.736554073620308, 29.71071569468427, 31.753124914561344, 34.06852452969114,
    36.588666941260506, 39.404548947686926, 42.42517375055285, 45.83253494669353, 49.55838493729558,
    53.71646972038111, 58.32953849555459, 63.60233405925534, 68.92209701234869, 74.36208270821454,
    79.71773792707663, 85.2984994066779, 90.97229540487065, 96.66762843718395, 102.46344364272112,
    108.27036916589343, 113.88463717595882, 119.29790629972881, 125.21165781479552, 131.32560228638079,
    137.21352375210594, 142.72527749458197, 148.61239303053048, 154.81231006103948, 161.07478739046041,
    167.90030741009014, 174.07856507785172, 180.42405317426721, 186.18483921772656, 191.69433635682802,
    197.6630925791507, 204.46614730625643, 212.02907292327205, 218.0337736136331, 226.45295932184524,
    233.82546388088403, 241.64751606933544, 248.21795931465698, 256.75010279714746, 266.3543007846128,
    274.188542660936, 281.57226979211447, 289.0316334328312
]
x_data=np.array(x_data)
y_data=np.array(y_data)

latexplot.figure()
plt.subplot(1, 2, 1)
plt.xlabel('winding surface separation ($L_{REGCOIL}$)')
plt.ylabel(r'$1/K_{\infty}$')
plt.title(r'Approximately $L_{REGCOIL} \propto 1/K_{\infty}$')
plt.plot(x_data, 1/y_data, marker='o', linestyle='-', label="data")

fit = np.polyfit(x_data, 1/y_data, 1)
print(fit)
plt.plot(x_data, np.polyval(fit, x_data), c='black', linestyle='--', label="fit")
plt.legend()


# The fit is very good when y_data = np.sqrt(y_data), is this a coincidence or worth investigating?
plt.subplot(1, 2, 2)
y_data=np.sqrt(y_data)
plt.xlabel('winding surface separation ($L_{REGCOIL}$)')
plt.ylabel(r'$1/\sqrt{K_{\infty}}$')
plt.title(r'Approximately $L_{REGCOIL} \propto 1/\sqrt{K_{\infty}}$')
plt.plot(x_data, 1/y_data, marker='o', linestyle='-', label="data")

fit = np.polyfit(x_data, 1/y_data, 1)
print(fit)
plt.plot(x_data, np.polyval(fit, x_data), c='black', linestyle='--', label="fit")
plt.legend()

latexplot.savenshow("almost_inverse")